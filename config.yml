# Active profile to use for sessions
active_profile: "default"

profiles:
  default:
    name: "Default"
    user_age: 7
    native_language: "en"
    learning_languages:
      ko:
        comprehension_age: 2
      es:
        comprehension_age: 2
      zh:
        comprehension_age: 2

# Supported learning languages
languages:
  ko:
    language_name: "Korean"
    model: "anyeong-choco"
    wake_word: "안녕 초코"
    sleep_word: "안녕 초코"
  es:
    language_name: "Mexican Spanish"
    model: "hola-choco"
    wake_word: "hola choco"
    sleep_word: "adiós choco"
  zh:
    language_name: "Mandarin Chinese (Simplified)"
    model: "nihao-choco"
    wake_word: "你好 choco"
    sleep_word: "再见 choco"
  en:
    language_name: "US English"
    model: "hey-choco"
    wake_word: "hey choco"
    sleep_word: "bye choco"

session:
  greeting_timeout: 5
  conversation_timeout: 90
  sleep_word_threshold: 80

summary:
  max_chars: 20000

display:
  width: 800
  height: 480
  frame_rates:   # fps
    refresh: 30  # screen refresh rate
    speaking: 8  # speaking animation
    sleeping: 1  # sleeping animation
  font: "NotoSansCJK-VF.otf.ttc"
  font_size: 24
  line_spacing: 12
  colors:
    idle_bg: "#141414"
    graphics_bg: "#0A2647"
    transcript_bg: "#144272"
    choco_text: "#33BDC4"
    user_text: "#33BDC4"
    active_text: "#FFFFFF"
  sprites:
    idle: "choco-idle.png"
    speaking: "choco-speaking.png"
    sleeping: "choco-sleeping.png"

sounds:
  awake: "awake.wav"
  sent: "sent.wav"
  bye: "bye.wav"

prompts:
  session: >
    You are Choco, a friendly {learning_language} tutor. Content must be suitable for a {user_age}-year-old.

    # Memory
    {memory_block}
    - Use memory to avoid repeating jokes, vocab, stories, facts, and topics unless asked.
    - Prefer novelty and steady progress when introducing new material.

    # Safety
    - If asked for inappropriate content, refuse briefly and redirect to something fun.

    # Style
    - Warm, patient, playful tone. Vary your phrasing naturally.
  transcription: >
    - Expect casual speech from a child in {native_language} and {learning_language}.
  response: >
    - Try to keep responses to 2-4 sentences. Exception for stories. End with a question.
    - Respond in {learning_language} using vocabulary appropriate for a {comprehension_age}-year-old native speaker.
    - Provide corrections in {native_language} only when the user makes a mistake.
    {translation_prompt}
  greeting: >
    Greet the user with up to 5 words in {learning_language}. Keep it brief.
  goodbye: >
    User said the sleep word. Respond with a brief goodbye in {learning_language} only.
  summary: >
    Summarize the session in {native_language}. Use 3-6 sentences and include progress, interests, corrections, and novelty.
    Return structured JSON matching the provided schema.

openwakeword:
  threshold: 0.3
  vad_threshold: 0.2
  sample_rate: 16000
  chunk_duration_ms: 80  # multiples of 80ms recommended
  input_gain: 1.0  # Audio input gain multiplier (1.0 = no change, 2.0 = double)

openai:
  model: "gpt-realtime-mini-2025-12-15"
  sample_rate: 24000
  chunk_duration_ms: 40
  input_gain: 1.0  # Audio input gain multiplier (1.0 = no change, 2.0 = double)
  requests:
    response:
      type: "response.create"
      response: {}
    user_message:
      type: "conversation.item.create"
      item:
        type: "message"
        role: "user"
        content:
          - type: "input_text"
    session:
      type: "session.update"
      session:
        type: "realtime"
        audio:
          input:
            noise_reduction:
              type: "far_field"
            transcription:
              model: "gpt-4o-mini-transcribe"
            turn_detection:
              type: "server_vad"
              threshold: 0.3
              prefix_padding_ms: 300
              silence_duration_ms: 800
              create_response: false
              interrupt_response: true
          output:
            speed: 0.8
            voice: "marin"
    summary:
      model: "gpt-4.1-nano"
      text:
        format:
          type: "json_schema"
          name: "chocopi_session_summary"
          schema:
            type: "object"
            additionalProperties: false
            properties:
              summary:
                type: "string"
              progress:
                type: "object"
                additionalProperties: false
                properties:
                  new_vocab:
                    type: "array"
                    items:
                      type: "string"
                  mistakes:
                    type: "array"
                    items:
                      type: "string"
                  strengths:
                    type: "array"
                    items:
                      type: "string"
                  next_focus:
                    type: "string"
                required: ["new_vocab", "mistakes", "strengths", "next_focus"]
              recent_items:
                type: "array"
                items:
                  type: "object"
                  additionalProperties: false
                  properties:
                    type:
                      type: "string"
                      enum: ["joke", "vocab", "story", "fact", "topic"]
                    text:
                      type: "string"
                  required: ["type", "text"]
              recent_user_requests:
                type: "array"
                items:
                  type: "string"
            required: ["summary", "progress", "recent_items", "recent_user_requests"]
